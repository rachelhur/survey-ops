2026-02-19 08:27:01 - INFO - Saving results in /home/hurra/Projects/survey-ops/experiment_results/bc-azel-grid-best
2026-02-19 08:27:01 - INFO - Loading raw data...
2026-02-19 08:27:02 - INFO - Loaded data from json
2026-02-19 08:27:02 - INFO - Processing raw data into OfflineDataset()...
2026-02-19 08:27:02 - INFO - Including the following bin features: ['angular_distance_to_pointing', 'ha', 'airmass', 'moon_distance']
2026-02-19 08:27:51 - DEBUG - Calculating ha for 54031 timestamps and 1504 bins
2026-02-19 08:27:51 - DEBUG - Calculating airmass for 54031 timestamps and 1504 bins
2026-02-19 08:27:51 - DEBUG - Calculating moon distance for 54031 timestamps and 1504 bins
2026-02-19 08:32:24 - DEBUG - Removing 883 transitions with large time diffs > 10 min. Total transitions: 54031
2026-02-19 08:32:24 - DEBUG - States shape: (53148, 24), Actions shape: (53148,), Rewards shape: (53148,), Next states shape: (53148, 24), Dones shape: (53148,), Action masks shape: (53148, 1504)
2026-02-19 08:32:24 - DEBUG - Bin states shape: (53148, 1504, 5), Next bin states shape: (53148, 1504, 5)
2026-02-19 08:32:26 - INFO - Finished constructing train_dataset
2026-02-19 08:32:26 - INFO - Plotting S x A (state x action) space cornerplot (this will take some time...)
2026-02-19 08:32:41 - INFO - Corner plot saved
2026-02-19 08:32:41 - INFO - Initializing agent...
2026-02-19 08:32:42 - DEBUG - lr_scheduler is <torch.optim.lr_scheduler.CosineAnnealingLR object at 0x75b2899b1d90>
2026-02-19 08:32:42 - DEBUG - Policy Network Structure:
2026-02-19 08:32:42 - DEBUG - ScoreMLP(
  (net): Sequential(
    (0): Linear(in_features=29, out_features=64, bias=True)
    (1): ReLU()
    (2): Linear(in_features=64, out_features=64, bias=True)
    (3): ReLU()
    (4): Linear(in_features=64, out_features=1, bias=True)
  )
)
2026-02-19 08:32:42 - INFO - Starting training...
2026-02-19 08:32:42 - INFO - Total number of training steps: 46500
2026-02-19 08:32:42 - INFO - Steps per epoch: 93
2026-02-19 08:32:42 - DEBUG - Total number of lr scheduler steps: 100
2026-02-19 08:32:42 - DEBUG - Number of transitions in dataset: 47833
2026-02-19 08:32:43 - INFO - Best val loss so far 100000.000 at epoch 0 
Validation check at train step 0 
 val_loss = 7.273 |  logp_expert_action = -7.273 |  action_margin = -0.009 |  entropy = 7.315 |  ang_sep = 0.435 |  unique_bins = 0.055 |  accuracy = 0.004 | 
val_loss (train batch) = 7.272 |  logp_expert_action (train batch) = -7.272 |  action_margin (train batch) = -0.009 |  entropy (train batch) = 7.315 |  ang_sep (train batch) = 0.437 |  unique_bins (train batch) = 0.053 |  accuracy (train batch) = 0.004 | 
2026-02-19 08:32:43 - INFO - Improved model at step 0. New best val loss is 7.273 Saving weights.
2026-02-19 08:32:44 - INFO - Best val loss so far 7.273 at epoch 1 
Validation check at train step 93 
 val_loss = 4.192 |  logp_expert_action = -4.192 |  action_margin = -1.036 |  entropy = 4.205 |  ang_sep = 0.190 |  unique_bins = 0.128 |  accuracy = 0.074 | 
val_loss (train batch) = 3.987 |  logp_expert_action (train batch) = -3.987 |  action_margin (train batch) = -0.827 |  entropy (train batch) = 4.202 |  ang_sep (train batch) = 0.181 |  unique_bins (train batch) = 0.126 |  accuracy (train batch) = 0.074 | 
2026-02-19 08:32:44 - INFO - Improved model at step 93. New best val loss is 4.192 Saving weights.
2026-02-19 08:32:45 - INFO - Best val loss so far 4.192 at epoch 2 
Validation check at train step 186 
 val_loss = 3.874 |  logp_expert_action = -3.874 |  action_margin = -1.107 |  entropy = 3.912 |  ang_sep = 0.162 |  unique_bins = 0.155 |  accuracy = 0.104 | 
val_loss (train batch) = 3.764 |  logp_expert_action (train batch) = -3.764 |  action_margin (train batch) = -1.030 |  entropy (train batch) = 3.880 |  ang_sep (train batch) = 0.156 |  unique_bins (train batch) = 0.154 |  accuracy (train batch) = 0.107 | 
2026-02-19 08:32:45 - INFO - Improved model at step 186. New best val loss is 3.874 Saving weights.
2026-02-19 08:32:47 - INFO - Best val loss so far 3.874 at epoch 3 
Validation check at train step 279 
 val_loss = 3.727 |  logp_expert_action = -3.727 |  action_margin = -1.315 |  entropy = 3.614 |  ang_sep = 0.163 |  unique_bins = 0.152 |  accuracy = 0.117 | 
val_loss (train batch) = 3.548 |  logp_expert_action (train batch) = -3.548 |  action_margin (train batch) = -1.170 |  entropy (train batch) = 3.585 |  ang_sep (train batch) = 0.144 |  unique_bins (train batch) = 0.145 |  accuracy (train batch) = 0.135 | 
2026-02-19 08:32:47 - INFO - Improved model at step 279. New best val loss is 3.727 Saving weights.
2026-02-19 08:32:48 - INFO - Best val loss so far 3.727 at epoch 4 
Validation check at train step 372 
 val_loss = 3.337 |  logp_expert_action = -3.337 |  action_margin = -1.032 |  entropy = 3.483 |  ang_sep = 0.112 |  unique_bins = 0.132 |  accuracy = 0.223 | 
val_loss (train batch) = 3.469 |  logp_expert_action (train batch) = -3.469 |  action_margin (train batch) = -1.195 |  entropy (train batch) = 3.467 |  ang_sep (train batch) = 0.122 |  unique_bins (train batch) = 0.137 |  accuracy (train batch) = 0.203 | 
2026-02-19 08:32:48 - INFO - Improved model at step 372. New best val loss is 3.337 Saving weights.
2026-02-19 08:32:49 - INFO - Best val loss so far 3.337 at epoch 5 
Validation check at train step 465 
 val_loss = 3.500 |  logp_expert_action = -3.500 |  action_margin = -1.370 |  entropy = 3.280 |  ang_sep = 0.124 |  unique_bins = 0.138 |  accuracy = 0.201 | 
val_loss (train batch) = 3.441 |  logp_expert_action (train batch) = -3.441 |  action_margin (train batch) = -1.309 |  entropy (train batch) = 3.281 |  ang_sep (train batch) = 0.117 |  unique_bins (train batch) = 0.138 |  accuracy (train batch) = 0.246 | 
2026-02-19 08:32:49 - DEBUG - Patience left: 39
2026-02-19 08:32:52 - INFO - Best val loss so far 3.337 at epoch 5 
Validation check at train step 558 
 val_loss = 3.223 |  logp_expert_action = -3.223 |  action_margin = -1.193 |  entropy = 3.110 |  ang_sep = 0.114 |  unique_bins = 0.137 |  accuracy = 0.223 | 
val_loss (train batch) = 3.353 |  logp_expert_action (train batch) = -3.353 |  action_margin (train batch) = -1.310 |  entropy (train batch) = 3.138 |  ang_sep (train batch) = 0.114 |  unique_bins (train batch) = 0.144 |  accuracy (train batch) = 0.207 | 
2026-02-19 08:32:52 - INFO - Improved model at step 558. New best val loss is 3.223 Saving weights.
2026-02-19 08:32:53 - INFO - Best val loss so far 3.223 at epoch 7 
Validation check at train step 651 
 val_loss = 3.582 |  logp_expert_action = -3.582 |  action_margin = -1.178 |  entropy = 3.609 |  ang_sep = 0.130 |  unique_bins = 0.148 |  accuracy = 0.141 | 
val_loss (train batch) = 3.877 |  logp_expert_action (train batch) = -3.877 |  action_margin (train batch) = -1.467 |  entropy (train batch) = 3.614 |  ang_sep (train batch) = 0.148 |  unique_bins (train batch) = 0.144 |  accuracy (train batch) = 0.133 | 
2026-02-19 08:32:53 - DEBUG - Patience left: 39
2026-02-19 08:32:54 - INFO - Best val loss so far 3.223 at epoch 7 
Validation check at train step 744 
 val_loss = 4.205 |  logp_expert_action = -4.205 |  action_margin = -1.770 |  entropy = 3.613 |  ang_sep = 0.165 |  unique_bins = 0.172 |  accuracy = 0.092 | 
val_loss (train batch) = 3.990 |  logp_expert_action (train batch) = -3.990 |  action_margin (train batch) = -1.553 |  entropy (train batch) = 3.626 |  ang_sep (train batch) = 0.173 |  unique_bins (train batch) = 0.164 |  accuracy (train batch) = 0.072 | 
2026-02-19 08:32:54 - DEBUG - Patience left: 38
2026-02-19 08:32:56 - INFO - Best val loss so far 3.223 at epoch 7 
Validation check at train step 837 
 val_loss = 21.636 |  logp_expert_action = -21.636 |  action_margin = -20.026 |  entropy = 2.448 |  ang_sep = 0.314 |  unique_bins = 0.061 |  accuracy = 0.023 | 
val_loss (train batch) = 21.671 |  logp_expert_action (train batch) = -21.671 |  action_margin (train batch) = -20.066 |  entropy (train batch) = 2.437 |  ang_sep (train batch) = 0.316 |  unique_bins (train batch) = 0.059 |  accuracy (train batch) = 0.021 | 
2026-02-19 08:32:56 - DEBUG - Patience left: 37
2026-02-19 08:32:57 - INFO - Best val loss so far 3.223 at epoch 7 
Validation check at train step 930 
 val_loss = 5.197 |  logp_expert_action = -5.197 |  action_margin = -2.802 |  entropy = 3.396 |  ang_sep = 0.224 |  unique_bins = 0.070 |  accuracy = 0.041 | 
val_loss (train batch) = 4.749 |  logp_expert_action (train batch) = -4.749 |  action_margin (train batch) = -2.367 |  entropy (train batch) = 3.363 |  ang_sep (train batch) = 0.197 |  unique_bins (train batch) = 0.129 |  accuracy (train batch) = 0.045 | 
2026-02-19 08:32:57 - DEBUG - Patience left: 36
2026-02-19 08:32:59 - INFO - Best val loss so far 3.223 at epoch 7 
Validation check at train step 1023 
 val_loss = 4.232 |  logp_expert_action = -4.232 |  action_margin = -2.011 |  entropy = 3.306 |  ang_sep = 0.179 |  unique_bins = 0.128 |  accuracy = 0.078 | 
val_loss (train batch) = 4.701 |  logp_expert_action (train batch) = -4.701 |  action_margin (train batch) = -2.455 |  entropy (train batch) = 3.328 |  ang_sep (train batch) = 0.189 |  unique_bins (train batch) = 0.125 |  accuracy (train batch) = 0.088 | 
2026-02-19 08:32:59 - DEBUG - Patience left: 35
2026-02-19 08:33:00 - INFO - Best val loss so far 3.223 at epoch 7 
Validation check at train step 1116 
 val_loss = 7.262 |  logp_expert_action = -7.262 |  action_margin = -4.723 |  entropy = 3.516 |  ang_sep = 0.267 |  unique_bins = 0.095 |  accuracy = 0.014 | 
val_loss (train batch) = 7.033 |  logp_expert_action (train batch) = -7.033 |  action_margin (train batch) = -4.521 |  entropy (train batch) = 3.484 |  ang_sep (train batch) = 0.251 |  unique_bins (train batch) = 0.100 |  accuracy (train batch) = 0.006 | 
2026-02-19 08:33:00 - DEBUG - Patience left: 34
2026-02-19 08:33:01 - INFO - Best val loss so far 3.223 at epoch 7 
Validation check at train step 1209 
 val_loss = 6.467 |  logp_expert_action = -6.467 |  action_margin = -4.210 |  entropy = 3.227 |  ang_sep = 0.222 |  unique_bins = 0.124 |  accuracy = 0.014 | 
val_loss (train batch) = 6.110 |  logp_expert_action (train batch) = -6.110 |  action_margin (train batch) = -3.869 |  entropy (train batch) = 3.198 |  ang_sep (train batch) = 0.222 |  unique_bins (train batch) = 0.128 |  accuracy (train batch) = 0.035 | 
2026-02-19 08:33:01 - DEBUG - Patience left: 33
2026-02-19 08:33:03 - INFO - Best val loss so far 3.223 at epoch 7 
Validation check at train step 1302 
 val_loss = 15.435 |  logp_expert_action = -15.435 |  action_margin = -13.966 |  entropy = 2.275 |  ang_sep = 0.247 |  unique_bins = 0.096 |  accuracy = 0.018 | 
val_loss (train batch) = 13.000 |  logp_expert_action (train batch) = -13.000 |  action_margin (train batch) = -11.529 |  entropy (train batch) = 2.289 |  ang_sep (train batch) = 0.245 |  unique_bins (train batch) = 0.090 |  accuracy (train batch) = 0.018 | 
2026-02-19 08:33:03 - DEBUG - Patience left: 32
2026-02-19 08:33:04 - INFO - Best val loss so far 3.223 at epoch 7 
Validation check at train step 1395 
 val_loss = 75.984 |  logp_expert_action = -75.984 |  action_margin = -75.200 |  entropy = 1.426 |  ang_sep = 1.067 |  unique_bins = 0.076 |  accuracy = 0.000 | 
val_loss (train batch) = 71.215 |  logp_expert_action (train batch) = -71.215 |  action_margin (train batch) = -70.407 |  entropy (train batch) = 1.478 |  ang_sep (train batch) = 1.095 |  unique_bins (train batch) = 0.073 |  accuracy (train batch) = 0.000 | 
2026-02-19 08:33:04 - DEBUG - Patience left: 31
2026-02-19 08:33:05 - INFO - Best val loss so far 3.223 at epoch 7 
Validation check at train step 1488 
 val_loss = 8.494 |  logp_expert_action = -8.494 |  action_margin = -6.460 |  entropy = 2.959 |  ang_sep = 0.245 |  unique_bins = 0.126 |  accuracy = 0.031 | 
val_loss (train batch) = 8.719 |  logp_expert_action (train batch) = -8.719 |  action_margin (train batch) = -6.641 |  entropy (train batch) = 3.001 |  ang_sep (train batch) = 0.245 |  unique_bins (train batch) = 0.127 |  accuracy (train batch) = 0.031 | 
2026-02-19 08:33:05 - DEBUG - Patience left: 30
2026-02-19 08:33:07 - INFO - Best val loss so far 3.223 at epoch 7 
Validation check at train step 1581 
 val_loss = 6.330 |  logp_expert_action = -6.330 |  action_margin = -4.337 |  entropy = 2.995 |  ang_sep = 0.229 |  unique_bins = 0.153 |  accuracy = 0.043 | 
val_loss (train batch) = 6.380 |  logp_expert_action (train batch) = -6.380 |  action_margin (train batch) = -4.398 |  entropy (train batch) = 2.968 |  ang_sep (train batch) = 0.224 |  unique_bins (train batch) = 0.148 |  accuracy (train batch) = 0.035 | 
2026-02-19 08:33:07 - DEBUG - Patience left: 29
2026-02-19 08:33:08 - INFO - Best val loss so far 3.223 at epoch 7 
Validation check at train step 1674 
 val_loss = 6.886 |  logp_expert_action = -6.886 |  action_margin = -5.312 |  entropy = 2.445 |  ang_sep = 0.224 |  unique_bins = 0.153 |  accuracy = 0.057 | 
val_loss (train batch) = 6.903 |  logp_expert_action (train batch) = -6.903 |  action_margin (train batch) = -5.269 |  entropy (train batch) = 2.494 |  ang_sep (train batch) = 0.220 |  unique_bins (train batch) = 0.140 |  accuracy (train batch) = 0.068 | 
2026-02-19 08:33:08 - DEBUG - Patience left: 28
2026-02-19 08:33:09 - INFO - Best val loss so far 3.223 at epoch 7 
Validation check at train step 1767 
 val_loss = 7.412 |  logp_expert_action = -7.412 |  action_margin = -5.832 |  entropy = 2.519 |  ang_sep = 0.212 |  unique_bins = 0.144 |  accuracy = 0.074 | 
val_loss (train batch) = 7.198 |  logp_expert_action (train batch) = -7.198 |  action_margin (train batch) = -5.654 |  entropy (train batch) = 2.442 |  ang_sep (train batch) = 0.215 |  unique_bins (train batch) = 0.147 |  accuracy (train batch) = 0.057 | 
2026-02-19 08:33:09 - DEBUG - Patience left: 27
2026-02-19 08:33:11 - INFO - Best val loss so far 3.223 at epoch 7 
Validation check at train step 1860 
 val_loss = 6.945 |  logp_expert_action = -6.945 |  action_margin = -5.516 |  entropy = 2.291 |  ang_sep = 0.194 |  unique_bins = 0.147 |  accuracy = 0.078 | 
val_loss (train batch) = 6.481 |  logp_expert_action (train batch) = -6.481 |  action_margin (train batch) = -5.069 |  entropy (train batch) = 2.253 |  ang_sep (train batch) = 0.182 |  unique_bins (train batch) = 0.154 |  accuracy (train batch) = 0.100 | 
2026-02-19 08:33:11 - DEBUG - Patience left: 26
2026-02-19 08:33:14 - INFO - Best val loss so far 3.223 at epoch 7 
Validation check at train step 1953 
 val_loss = 13.310 |  logp_expert_action = -13.310 |  action_margin = -12.345 |  entropy = 1.616 |  ang_sep = 0.227 |  unique_bins = 0.078 |  accuracy = 0.041 | 
val_loss (train batch) = 13.753 |  logp_expert_action (train batch) = -13.753 |  action_margin (train batch) = -12.792 |  entropy (train batch) = 1.575 |  ang_sep (train batch) = 0.224 |  unique_bins (train batch) = 0.147 |  accuracy (train batch) = 0.035 | 
2026-02-19 08:33:14 - DEBUG - Patience left: 25
2026-02-19 08:33:17 - INFO - Best val loss so far 3.223 at epoch 7 
Validation check at train step 2046 
 val_loss = 5.590 |  logp_expert_action = -5.590 |  action_margin = -4.118 |  entropy = 2.399 |  ang_sep = 0.200 |  unique_bins = 0.145 |  accuracy = 0.080 | 
val_loss (train batch) = 5.576 |  logp_expert_action (train batch) = -5.576 |  action_margin (train batch) = -4.042 |  entropy (train batch) = 2.452 |  ang_sep (train batch) = 0.202 |  unique_bins (train batch) = 0.159 |  accuracy (train batch) = 0.078 | 
2026-02-19 08:33:17 - DEBUG - Patience left: 24
2026-02-19 08:33:18 - INFO - Best val loss so far 3.223 at epoch 7 
Validation check at train step 2139 
 val_loss = 17.549 |  logp_expert_action = -17.549 |  action_margin = -16.378 |  entropy = 1.885 |  ang_sep = 0.255 |  unique_bins = 0.100 |  accuracy = 0.018 | 
val_loss (train batch) = 17.034 |  logp_expert_action (train batch) = -17.034 |  action_margin (train batch) = -15.873 |  entropy (train batch) = 1.866 |  ang_sep (train batch) = 0.265 |  unique_bins (train batch) = 0.108 |  accuracy (train batch) = 0.025 | 
2026-02-19 08:33:18 - DEBUG - Patience left: 23
2026-02-19 08:33:19 - INFO - Best val loss so far 3.223 at epoch 7 
Validation check at train step 2232 
 val_loss = 6.886 |  logp_expert_action = -6.886 |  action_margin = -5.245 |  entropy = 2.515 |  ang_sep = 0.202 |  unique_bins = 0.141 |  accuracy = 0.043 | 
val_loss (train batch) = 6.894 |  logp_expert_action (train batch) = -6.894 |  action_margin (train batch) = -5.229 |  entropy (train batch) = 2.526 |  ang_sep (train batch) = 0.187 |  unique_bins (train batch) = 0.135 |  accuracy (train batch) = 0.068 | 
2026-02-19 08:33:19 - DEBUG - Patience left: 22
2026-02-19 08:33:21 - INFO - Best val loss so far 3.223 at epoch 7 
Validation check at train step 2325 
 val_loss = 7.931 |  logp_expert_action = -7.931 |  action_margin = -6.406 |  entropy = 2.342 |  ang_sep = 0.171 |  unique_bins = 0.136 |  accuracy = 0.090 | 
val_loss (train batch) = 6.191 |  logp_expert_action (train batch) = -6.191 |  action_margin (train batch) = -4.663 |  entropy (train batch) = 2.367 |  ang_sep (train batch) = 0.169 |  unique_bins (train batch) = 0.124 |  accuracy (train batch) = 0.061 | 
2026-02-19 08:33:21 - DEBUG - Patience left: 21
2026-02-19 08:33:22 - INFO - Best val loss so far 3.223 at epoch 7 
Validation check at train step 2418 
 val_loss = 15.536 |  logp_expert_action = -15.536 |  action_margin = -14.556 |  entropy = 1.555 |  ang_sep = 0.220 |  unique_bins = 0.140 |  accuracy = 0.043 | 
val_loss (train batch) = 17.739 |  logp_expert_action (train batch) = -17.739 |  action_margin (train batch) = -16.756 |  entropy (train batch) = 1.571 |  ang_sep (train batch) = 0.235 |  unique_bins (train batch) = 0.140 |  accuracy (train batch) = 0.043 | 
2026-02-19 08:33:22 - DEBUG - Patience left: 20
2026-02-19 08:33:23 - INFO - Best val loss so far 3.223 at epoch 7 
Validation check at train step 2511 
 val_loss = 15.097 |  logp_expert_action = -15.097 |  action_margin = -13.793 |  entropy = 2.153 |  ang_sep = 0.286 |  unique_bins = 0.157 |  accuracy = 0.016 | 
val_loss (train batch) = 15.028 |  logp_expert_action (train batch) = -15.028 |  action_margin (train batch) = -13.742 |  entropy (train batch) = 2.145 |  ang_sep (train batch) = 0.259 |  unique_bins (train batch) = 0.160 |  accuracy (train batch) = 0.021 | 
2026-02-19 08:33:23 - DEBUG - Patience left: 19
2026-02-19 08:33:24 - INFO - Best val loss so far 3.223 at epoch 7 
Validation check at train step 2604 
 val_loss = 10.098 |  logp_expert_action = -10.098 |  action_margin = -9.127 |  entropy = 1.521 |  ang_sep = 0.187 |  unique_bins = 0.144 |  accuracy = 0.062 | 
val_loss (train batch) = 10.756 |  logp_expert_action (train batch) = -10.756 |  action_margin (train batch) = -9.732 |  entropy (train batch) = 1.597 |  ang_sep (train batch) = 0.192 |  unique_bins (train batch) = 0.141 |  accuracy (train batch) = 0.072 | 
2026-02-19 08:33:24 - DEBUG - Patience left: 18
2026-02-19 08:33:26 - INFO - Best val loss so far 3.223 at epoch 7 
Validation check at train step 2697 
 val_loss = 83.307 |  logp_expert_action = -83.307 |  action_margin = -82.039 |  entropy = 2.063 |  ang_sep = 0.815 |  unique_bins = 0.092 |  accuracy = 0.000 | 
val_loss (train batch) = 83.733 |  logp_expert_action (train batch) = -83.733 |  action_margin (train batch) = -82.466 |  entropy (train batch) = 2.078 |  ang_sep (train batch) = 0.828 |  unique_bins (train batch) = 0.096 |  accuracy (train batch) = 0.000 | 
2026-02-19 08:33:26 - DEBUG - Patience left: 17
2026-02-19 08:33:27 - INFO - Best val loss so far 3.223 at epoch 7 
Validation check at train step 2790 
 val_loss = 14.825 |  logp_expert_action = -14.825 |  action_margin = -13.793 |  entropy = 1.514 |  ang_sep = 0.192 |  unique_bins = 0.136 |  accuracy = 0.070 | 
val_loss (train batch) = 13.981 |  logp_expert_action (train batch) = -13.981 |  action_margin (train batch) = -12.983 |  entropy (train batch) = 1.501 |  ang_sep (train batch) = 0.207 |  unique_bins (train batch) = 0.138 |  accuracy (train batch) = 0.051 | 
2026-02-19 08:33:27 - DEBUG - Patience left: 16
2026-02-19 08:33:28 - INFO - Best val loss so far 3.223 at epoch 7 
Validation check at train step 2883 
 val_loss = 19.117 |  logp_expert_action = -19.117 |  action_margin = -18.238 |  entropy = 1.361 |  ang_sep = 0.254 |  unique_bins = 0.156 |  accuracy = 0.043 | 
val_loss (train batch) = 22.695 |  logp_expert_action (train batch) = -22.695 |  action_margin (train batch) = -21.821 |  entropy (train batch) = 1.344 |  ang_sep (train batch) = 0.262 |  unique_bins (train batch) = 0.150 |  accuracy (train batch) = 0.039 | 
2026-02-19 08:33:28 - DEBUG - Patience left: 15
2026-02-19 08:33:30 - INFO - Best val loss so far 3.223 at epoch 7 
Validation check at train step 2976 
 val_loss = 11.147 |  logp_expert_action = -11.147 |  action_margin = -9.954 |  entropy = 1.810 |  ang_sep = 0.287 |  unique_bins = 0.072 |  accuracy = 0.031 | 
val_loss (train batch) = 11.172 |  logp_expert_action (train batch) = -11.172 |  action_margin (train batch) = -9.944 |  entropy (train batch) = 1.834 |  ang_sep (train batch) = 0.294 |  unique_bins (train batch) = 0.121 |  accuracy (train batch) = 0.027 | 
2026-02-19 08:33:30 - DEBUG - Patience left: 14
2026-02-19 08:33:32 - INFO - Best val loss so far 3.223 at epoch 7 
Validation check at train step 3069 
 val_loss = 9.574 |  logp_expert_action = -9.574 |  action_margin = -8.266 |  entropy = 1.834 |  ang_sep = 0.189 |  unique_bins = 0.119 |  accuracy = 0.072 | 
val_loss (train batch) = 10.460 |  logp_expert_action (train batch) = -10.460 |  action_margin (train batch) = -9.170 |  entropy (train batch) = 1.868 |  ang_sep (train batch) = 0.194 |  unique_bins (train batch) = 0.125 |  accuracy (train batch) = 0.059 | 
2026-02-19 08:33:32 - DEBUG - Patience left: 13
2026-02-19 08:33:33 - INFO - Best val loss so far 3.223 at epoch 7 
Validation check at train step 3162 
 val_loss = 9.587 |  logp_expert_action = -9.587 |  action_margin = -8.408 |  entropy = 1.748 |  ang_sep = 0.247 |  unique_bins = 0.146 |  accuracy = 0.066 | 
val_loss (train batch) = 9.331 |  logp_expert_action (train batch) = -9.331 |  action_margin (train batch) = -8.156 |  entropy (train batch) = 1.790 |  ang_sep (train batch) = 0.252 |  unique_bins (train batch) = 0.152 |  accuracy (train batch) = 0.045 | 
2026-02-19 08:33:33 - DEBUG - Patience left: 12
2026-02-19 08:33:34 - INFO - Best val loss so far 3.223 at epoch 7 
Validation check at train step 3255 
 val_loss = 20.691 |  logp_expert_action = -20.691 |  action_margin = -19.922 |  entropy = 0.959 |  ang_sep = 0.196 |  unique_bins = 0.158 |  accuracy = 0.066 | 
val_loss (train batch) = 20.934 |  logp_expert_action (train batch) = -20.934 |  action_margin (train batch) = -20.240 |  entropy (train batch) = 0.965 |  ang_sep (train batch) = 0.196 |  unique_bins (train batch) = 0.151 |  accuracy (train batch) = 0.066 | 
2026-02-19 08:33:34 - DEBUG - Patience left: 11
2026-02-19 08:33:37 - INFO - Best val loss so far 3.223 at epoch 7 
Validation check at train step 3348 
 val_loss = 16.947 |  logp_expert_action = -16.947 |  action_margin = -16.037 |  entropy = 1.290 |  ang_sep = 0.222 |  unique_bins = 0.134 |  accuracy = 0.047 | 
val_loss (train batch) = 16.417 |  logp_expert_action (train batch) = -16.417 |  action_margin (train batch) = -15.525 |  entropy (train batch) = 1.291 |  ang_sep (train batch) = 0.224 |  unique_bins (train batch) = 0.122 |  accuracy (train batch) = 0.047 | 
2026-02-19 08:33:37 - DEBUG - Patience left: 10
2026-02-19 08:33:38 - INFO - Best val loss so far 3.223 at epoch 7 
Validation check at train step 3441 
 val_loss = 8.759 |  logp_expert_action = -8.759 |  action_margin = -7.641 |  entropy = 1.679 |  ang_sep = 0.200 |  unique_bins = 0.134 |  accuracy = 0.037 | 
val_loss (train batch) = 9.171 |  logp_expert_action (train batch) = -9.171 |  action_margin (train batch) = -8.014 |  entropy (train batch) = 1.677 |  ang_sep (train batch) = 0.202 |  unique_bins (train batch) = 0.147 |  accuracy (train batch) = 0.092 | 
2026-02-19 08:33:38 - DEBUG - Patience left: 9
2026-02-19 08:33:40 - INFO - Best val loss so far 3.223 at epoch 7 
Validation check at train step 3534 
 val_loss = 9.927 |  logp_expert_action = -9.927 |  action_margin = -8.793 |  entropy = 1.653 |  ang_sep = 0.199 |  unique_bins = 0.148 |  accuracy = 0.086 | 
val_loss (train batch) = 8.061 |  logp_expert_action (train batch) = -8.061 |  action_margin (train batch) = -6.891 |  entropy (train batch) = 1.644 |  ang_sep (train batch) = 0.187 |  unique_bins (train batch) = 0.141 |  accuracy (train batch) = 0.078 | 
2026-02-19 08:33:40 - DEBUG - Patience left: 8
2026-02-19 08:33:41 - INFO - Best val loss so far 3.223 at epoch 7 
Validation check at train step 3627 
 val_loss = 19.428 |  logp_expert_action = -19.428 |  action_margin = -18.740 |  entropy = 0.865 |  ang_sep = 0.190 |  unique_bins = 0.144 |  accuracy = 0.090 | 
val_loss (train batch) = 17.476 |  logp_expert_action (train batch) = -17.476 |  action_margin (train batch) = -16.758 |  entropy (train batch) = 0.923 |  ang_sep (train batch) = 0.205 |  unique_bins (train batch) = 0.138 |  accuracy (train batch) = 0.078 | 
2026-02-19 08:33:41 - DEBUG - Patience left: 7
2026-02-19 08:33:42 - INFO - Best val loss so far 3.223 at epoch 7 
Validation check at train step 3720 
 val_loss = 9.491 |  logp_expert_action = -9.491 |  action_margin = -8.400 |  entropy = 1.530 |  ang_sep = 0.198 |  unique_bins = 0.156 |  accuracy = 0.080 | 
val_loss (train batch) = 9.693 |  logp_expert_action (train batch) = -9.693 |  action_margin (train batch) = -8.611 |  entropy (train batch) = 1.506 |  ang_sep (train batch) = 0.193 |  unique_bins (train batch) = 0.141 |  accuracy (train batch) = 0.070 | 
2026-02-19 08:33:42 - DEBUG - Patience left: 6
2026-02-19 08:33:44 - INFO - Best val loss so far 3.223 at epoch 7 
Validation check at train step 3813 
 val_loss = 14.283 |  logp_expert_action = -14.283 |  action_margin = -13.244 |  entropy = 1.541 |  ang_sep = 0.311 |  unique_bins = 0.167 |  accuracy = 0.068 | 
val_loss (train batch) = 14.027 |  logp_expert_action (train batch) = -14.027 |  action_margin (train batch) = -13.043 |  entropy (train batch) = 1.498 |  ang_sep (train batch) = 0.340 |  unique_bins (train batch) = 0.153 |  accuracy (train batch) = 0.041 | 
2026-02-19 08:33:44 - DEBUG - Patience left: 5
2026-02-19 08:33:45 - INFO - Best val loss so far 3.223 at epoch 7 
Validation check at train step 3906 
 val_loss = 42.718 |  logp_expert_action = -42.718 |  action_margin = -42.170 |  entropy = 0.709 |  ang_sep = 0.238 |  unique_bins = 0.138 |  accuracy = 0.041 | 
val_loss (train batch) = 38.663 |  logp_expert_action (train batch) = -38.663 |  action_margin (train batch) = -38.098 |  entropy (train batch) = 0.706 |  ang_sep (train batch) = 0.233 |  unique_bins (train batch) = 0.140 |  accuracy (train batch) = 0.047 | 
2026-02-19 08:33:45 - DEBUG - Patience left: 4
2026-02-19 08:33:46 - INFO - Best val loss so far 3.223 at epoch 7 
Validation check at train step 3999 
 val_loss = 14.419 |  logp_expert_action = -14.419 |  action_margin = -13.379 |  entropy = 1.431 |  ang_sep = 0.205 |  unique_bins = 0.074 |  accuracy = 0.067 | 
val_loss (train batch) = 14.596 |  logp_expert_action (train batch) = -14.596 |  action_margin (train batch) = -13.596 |  entropy (train batch) = 1.392 |  ang_sep (train batch) = 0.202 |  unique_bins (train batch) = 0.138 |  accuracy (train batch) = 0.051 | 
2026-02-19 08:33:46 - DEBUG - Patience left: 3
2026-02-19 08:33:48 - INFO - Best val loss so far 3.223 at epoch 7 
Validation check at train step 4092 
 val_loss = 16.142 |  logp_expert_action = -16.142 |  action_margin = -15.213 |  entropy = 1.248 |  ang_sep = 0.238 |  unique_bins = 0.122 |  accuracy = 0.041 | 
val_loss (train batch) = 18.245 |  logp_expert_action (train batch) = -18.245 |  action_margin (train batch) = -17.338 |  entropy (train batch) = 1.242 |  ang_sep (train batch) = 0.246 |  unique_bins (train batch) = 0.122 |  accuracy (train batch) = 0.049 | 
2026-02-19 08:33:48 - DEBUG - Patience left: 2
2026-02-19 08:33:50 - INFO - Best val loss so far 3.223 at epoch 7 
Validation check at train step 4185 
 val_loss = 10.216 |  logp_expert_action = -10.216 |  action_margin = -9.098 |  entropy = 1.569 |  ang_sep = 0.203 |  unique_bins = 0.135 |  accuracy = 0.059 | 
val_loss (train batch) = 11.423 |  logp_expert_action (train batch) = -11.423 |  action_margin (train batch) = -10.303 |  entropy (train batch) = 1.528 |  ang_sep (train batch) = 0.205 |  unique_bins (train batch) = 0.142 |  accuracy (train batch) = 0.049 | 
2026-02-19 08:33:50 - DEBUG - Patience left: 1
2026-02-19 08:33:51 - INFO - Best val loss so far 3.223 at epoch 7 
Validation check at train step 4278 
 val_loss = 8.822 |  logp_expert_action = -8.822 |  action_margin = -7.631 |  entropy = 1.610 |  ang_sep = 0.185 |  unique_bins = 0.134 |  accuracy = 0.049 | 
val_loss (train batch) = 9.936 |  logp_expert_action (train batch) = -9.936 |  action_margin (train batch) = -8.697 |  entropy (train batch) = 1.613 |  ang_sep (train batch) = 0.200 |  unique_bins (train batch) = 0.124 |  accuracy (train batch) = 0.064 | 
2026-02-19 08:33:51 - DEBUG - Patience left: 0
2026-02-19 08:33:51 - INFO - No patience left. Ending training.
2026-02-19 08:33:51 - INFO - Best val loss was 3.223 at epoch 7
2026-02-19 08:33:51 - INFO - Total train time = 69.36067152023315s on cuda
2026-02-19 08:33:51 - INFO - Training complete.
2026-02-19 08:33:51 - INFO - Plotting training loss curve...
