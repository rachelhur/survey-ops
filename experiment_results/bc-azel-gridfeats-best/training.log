2026-02-09 19:38:51 - INFO - Setting outdir /home/hurra/Projects/survey-ops/experiment_results/bc-azel-gridfeats-best
2026-02-09 19:38:51 - INFO - Saving results in /home/hurra/Projects/survey-ops/experiment_results/bc-azel-gridfeats-best
2026-02-09 19:38:51 - INFO - Loading raw data...
2026-02-09 19:38:52 - INFO - Loaded data from json
2026-02-09 19:38:52 - INFO - Processing raw data into OfflineDataset()...
2026-02-09 19:38:57 - INFO - Calculating ha for 1942 timestamps and 1504 bins
2026-02-09 19:38:57 - INFO - Calculating airmass for 1942 timestamps and 1504 bins
2026-02-09 19:38:57 - INFO - Calculating moon distance for 1942 timestamps and 1504 bins
2026-02-09 19:38:57 - INFO - Calculating xs for 1942 timestamps and 1504 bins
2026-02-09 19:38:57 - INFO - Calculating ys for 1942 timestamps and 1504 bins
2026-02-09 19:39:14 - DEBUG - Removing 39 transitions with large time diffs > 10 min. Total transitions: 1942
2026-02-09 19:39:15 - INFO - Finished constructing train_dataset
2026-02-09 19:39:15 - INFO - Plotting S x A (state x action) space cornerplot (this will take some time...)
2026-02-09 19:39:25 - INFO - Corner plot saved
2026-02-09 19:39:26 - INFO - Initializing agent...
2026-02-09 19:39:26 - INFO - Starting training...
2026-02-09 19:39:27 - INFO - Total number of training steps: 800
2026-02-09 19:39:27 - INFO - Steps per epoch: 1
2026-02-09 19:39:27 - DEBUG - Total number of lr scheduler steps: None
2026-02-09 19:39:27 - DEBUG - Number of transitions in dataset: 1712
2026-02-09 19:39:28 - INFO - Best val loss so far 100000.000 at epoch 0 
Validation check at train step 0 
 val_loss = 6.658 |  logp_expert_action = -6.658 |  action_margin = -1.504 |  entropy = 7.060 |  ang_sep = 0.616 |  unique_bins = 0.001 |  accuracy = 0.000 | 
val_loss (train batch) = 6.619 |  logp_expert_action (train batch) = -6.619 |  action_margin (train batch) = -1.467 |  entropy (train batch) = 7.058 |  ang_sep (train batch) = 0.635 |  unique_bins (train batch) = 0.001 |  accuracy (train batch) = 0.007 | 
2026-02-09 19:39:28 - INFO - Improved model at step 0. New best val loss is 6.658 Saving weights.
2026-02-09 19:39:29 - INFO - Best val loss so far 6.658 at epoch 1 
Validation check at train step 1 
 val_loss = 6.227 |  logp_expert_action = -6.227 |  action_margin = -4.580 |  entropy = 4.959 |  ang_sep = 0.547 |  unique_bins = 0.001 |  accuracy = 0.016 | 
val_loss (train batch) = 5.983 |  logp_expert_action (train batch) = -5.983 |  action_margin (train batch) = -4.323 |  entropy (train batch) = 4.929 |  ang_sep (train batch) = 0.566 |  unique_bins (train batch) = 0.001 |  accuracy (train batch) = 0.035 | 
2026-02-09 19:39:29 - INFO - Improved model at step 1. New best val loss is 6.227 Saving weights.
2026-02-09 19:39:29 - INFO - Best val loss so far 6.227 at epoch 2 
Validation check at train step 2 
 val_loss = 5.851 |  logp_expert_action = -5.851 |  action_margin = -3.025 |  entropy = 4.998 |  ang_sep = 0.510 |  unique_bins = 0.003 |  accuracy = 0.063 | 
val_loss (train batch) = 5.749 |  logp_expert_action (train batch) = -5.749 |  action_margin (train batch) = -2.937 |  entropy (train batch) = 4.990 |  ang_sep (train batch) = 0.514 |  unique_bins (train batch) = 0.003 |  accuracy (train batch) = 0.040 | 
2026-02-09 19:39:29 - INFO - Improved model at step 2. New best val loss is 5.851 Saving weights.
